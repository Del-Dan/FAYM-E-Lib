{% if books %}
{% for book in books %}
<div
    class="bg-white rounded-xl shadow-sm hover:shadow-xl transition-shadow duration-300 border border-slate-100 overflow-hidden group flex flex-col h-full">
    <div class="p-6 flex-1">
        <div class="flex justify-between items-start mb-4">
            <span
                class="px-2 py-1 rounded text-xs font-bold uppercase tracking-wider 
                    {% if book.type == 'SC' %}bg-purple-100 text-purple-700{% else %}bg-amber-100 text-amber-700{% endif %}">
                {{ book.get_type_display }}
            </span>
            <span
                class="flex items-center space-x-1 text-xs font-medium 
                    {% if book.is_available %}text-green-600 bg-green-50 px-2 py-0.5 rounded-full{% else %}text-red-600 bg-red-50 px-2 py-0.5 rounded-full{% endif %}">
                <span
                    class="w-2 h-2 rounded-full {% if book.is_available %}bg-green-500{% else %}bg-red-500{% endif %}"></span>
                <span>{{ book.get_availability_display }}</span>
            </span>
        </div>

        <h3 class="text-xl font-bold text-slate-900 mb-1 group-hover:text-blue-600 transition-colors line-clamp-2">{{
            book.title }}</h3>
        <p class="text-slate-500 text-sm mb-4">{{ book.author }}</p>

        <div class="flex flex-wrap gap-1 mb-4">
            {% for tag in book.keywords.split|slice:":3" %}
            <!-- Basic split, assume comma not handled in template well without tag, but split works on space default, for comma use custom filter if needed, using simple logic here -->
            <span class="text-xs text-slate-400 bg-slate-50 px-2 py-1 rounded border border-slate-100">{{ tag }}</span>
            {% endfor %}
        </div>
    </div>

    <div class="p-4 bg-slate-50 border-t border-slate-100 mt-auto">
        {% if book.is_available %}
        <button
            @click="$dispatch('open-request-modal', { id: '{{ book.book_id }}', title: '{{ book.title|escapejs }}' })"
            class="w-full py-2 bg-white border border-blue-200 text-blue-600 font-semibold rounded-lg hover:bg-blue-600 hover:text-white transition-all shadow-sm">
            Request Book
        </button>
        {% else %}
        <button disabled class="w-full py-2 bg-slate-100 text-slate-400 font-semibold rounded-lg cursor-not-allowed">
            Currently Unavailable
        </button>
        {% endif %}
    </div>
</div>
{% endfor %}
{% else %}
<div class="col-span-full text-center py-12">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-slate-300 mb-4" fill="none"
        viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
    </svg>
    <p class="text-slate-500 text-lg">No books found matching your criteria.</p>
</div>
{% endif %}